Telegram-бот для подбора TPMS-датчиков по автомобилю
(марка → год выпуска → модель) с сохранением лидов и привязкой к менеджерам.

Данный документ предназначен для внутреннего использования.

Назначение

Бот реализует пошаговый сценарий подбора TPMS-датчиков на основе Excel-каталога, собирает контактные данные клиента и передаёт лид ответственному менеджеру.

Как работает бот

Пользователь выбирает:

марку автомобиля

год выпуска

модель

Бот показывает список подходящих датчиков.

Пользователь выбирает датчик.

Бот запрашивает имя и телефон.

Лид сохраняется в файл и отправляется менеджеру.

Поддерживается ручной ввод марки, года и модели.

Структура проекта
.
├── bot.py                 # Основная логика Telegram-бота (aiogram 3)
├── data_loader.py         # Загрузка и индексация Excel-каталога
├── requirements.txt       # Python-зависимости
├── .env                   # Переменные окружения
├── runtime.txt            # Версия Python (опционально)
├── data/
│   ├── brands.xlsx
│   ├── brandmodels.xlsx
│   ├── applicability.xlsx
│   ├── products.xlsx
│   └── brand_aliases.xlsx
├── leads.csv              # Лиды (создаётся автоматически)
└── managers.csv           # Менеджеры (создаётся автоматически)

Требования

Python 3.13.5

pip

Linux / macOS / Windows

Установка
1. Клонирование репозитория
git clone <repo_url>
cd alltpms-bot

2. Создание виртуального окружения
python3.13 -m venv venv
source venv/bin/activate

3. Установка зависимостей
pip install -r requirements.txt

Конфигурация

Создайте файл .env в корне проекта:

BOT_TOKEN=YOUR_TELEGRAM_BOT_TOKEN

MANAGER_KEYS=key_xxx,key_yyy,key_zzz
ADMIN_CHAT_ID=

IMG_BASE=https://alltpms.ru/img/
SITE_BASE=https://alltpms.ru/

LEADS_CSV=leads.csv
MANAGERS_CSV=managers.csv

LOG_LEVEL=DEBUG

Запуск
python bot.py


При успешном запуске в логах появится сообщение:

>>> bot.py ЗАПУСТИЛСЯ

Режим менеджера

Для регистрации менеджера необходимо отправить боту сообщение:

key_xxx


Ключ должен присутствовать в переменной MANAGER_KEYS.

Клиенты, пришедшие по соответствующему ключу, автоматически закрепляются за менеджером.

Лиды

все лиды сохраняются в файл leads.csv

структура лида включает:

марку

год выпуска

модель

выбранный датчик

артикул

цену

имя клиента

телефон

менеджера

После сохранения лида менеджеру отправляется уведомление в Telegram.

Каталог (Excel)
Обязательные файлы

brands.xlsx

brandmodels.xlsx

applicability.xlsx

products.xlsx

Опционально

brand_aliases.xlsx — алиасы брендов

Лицензия

Проект используется в коммерческих целях.
Все права принадлежат владельцу проекта.
